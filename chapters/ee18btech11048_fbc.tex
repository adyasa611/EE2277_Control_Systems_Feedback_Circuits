Figure \ref{fig:ee18btech11048_original_circuit} shows a feedback transconductance
amplifier implemented using an op amp with open-loop gain $\mu$, a very large input resistance, and an output resistance $r_{o}$.
The output current $I_{o}$ that is delivered to the load resistance $R_{L}$
is sensed by the feedback network composed of the three
resistances $R_{M}$, $R_{1}$, and $R_{2}$, and a proportional voltage$V_{f}$
is fed back to the negative-input terminal of the op amp.
Find G,H and T. If the loop gain is large, find an approximate expression for T
and state precisely the condition for which this applies.
\begin{figure}[!ht]
	\begin{center}
		\resizebox{\columnwidth}{!}{\input{./figs/ee18btech11048_fbc1.tex}}
	\end{center}
\caption{}
\label{fig:ee18btech11048_original_circuit}
\end{figure}
The parameters given are shown in the TABLE.\ref{table:ee18btech11048_ Table1}
\begin{table}[!ht]
\centering
\input{./tables/ee18btech11048_table1.tex}
\caption{1}
\label{table:ee18btech11048_ Table1}
\end{table}

\begin{enumerate}[label=\arabic*.,ref=\theenumi]
%\begin{enumerate}[label=\thesubsection.\arabic*.,ref=\thesubsection.\theenumi]
\numberwithin{equation}{enumi}

\item Draw the block diagram and the equivalent circuit for Fig. \ref{fig:ee18btech11048_original_circuit}\\
\solution
The equivalent circuit of the amplifier is in Fig. \ref{fig:ee18btech11048_ss_circuit}

\begin{figure}[!ht]
	\begin{center}
		\resizebox{\columnwidth}{!}{\input{./figs/ee18btech11048_fbc2.tex}}
	\end{center}
\caption{}
\label{fig:ee18btech11048_ss_circuit}
\end{figure}


\item Draw the block diagram and equivalent ciruit for $H$.
\\
\solution See Fig. \ref{fig:ee18btech11048_original_circuit} and \ref{fig:ee18btech11048_ss_circuit}.
\item Find  $H$.
\\
\solution From Fig. \ref{fig:ee18btech11048_ss_circuit},

\begin{align}
H &= \frac{V_{f}}{I_{o}} 
\\
&= \frac{R_1R_M}{R_1+R_2+R_M}
\label{eq:ee18btech11048_H}
\end{align}
%
\item Find  $G$.
\\
\solution From Fig. \ref{fig:ee18btech11048_ss_circuit},
\begin{align}
G &= \frac{I_{o}}{V_{i}} \label{eq:ee18btech11048_G}\\
&= \mu
\end{align}
\item  Find $T$.
\\
\solution
\begin{align}
T &= \frac{G}{1+GH} \label{eq:ee18btech11048_T}
\\
&= \frac{\mu \brak{R_1+R_2+R_M}}{R_1+R_2+R_M+ \mu R_1R_M}
\\
 &\approx \frac{1}{H}  = \frac{R_1+R_2+R_M}{R_1R_M} 
\end{align}

\item Summarize your results in a table.
\\
\solution See Table \ref{table:ee18btech11048_ Input_Table}


\begin{table}[!ht]
\centering
\input{./tables/ee18btech11048_tables2.tex}
\caption{}
\label{table:ee18btech11048_ Input_Table}
\end{table}


\item Find $I_o$ for the parameters given in  Table  \ref{table:ee18btech11048_ Example_Table}.
\begin{table}[!ht]
\centering
\input{./tables/ee18btech11048_tables3.tex}
\caption{}
\label{table:ee18btech11048_ Example_Table}
\end{table}
\solution  The following code computes the value of $V_o$ using the fact that
\begin{align}
I_o &= \frac{V_s}{H}\\
\implies I_o &= \frac{3}{1000} A
\end{align}
%From Fig\ref{fig:ee18btech11048_original_circuit}
%\begin{align}
%V_o - V_A &= I_o R_L \\
%V_A &= I_o\brak{R_M\parallel\brak{R_1+R_2}}\\
%\implies V_o &= I_o\brak{R_L+\brak{R_M\parallel\brak{R_1+R_2}}}
%\end{align}
%Dividing both sides by $V_s$
%\begin{align}
%\frac{V_o}{V_s} &= \frac{I_o}{V_s}\brak{R_L+\brak{R_M\parallel\brak{R_1+R_2}}} \label{eq:ee18btech11048_eee}
%\end{align}
%From equation \ref{eq:ee18btech11048_To} and \ref{eq:ee18btech11048_eee}
%\begin{align}
% \frac{V_o}{V_s} &= T\brak{R_L+\brak{R_M\parallel\brak{R_1+R_2}}} \label{eq:ee18btech11048_final}
%\end{align}
%From values in table\ref{table:ee18btech11048_ Example_Table} 
%\begin{align}
% H&= \frac{\brak{1000}\brak{1000}}{1000+1000+1000}\\
% \implies H&= \frac{1000}{3}
%\end{align}
%For an op amp:
%\begin{align}
% G \in \brak{20000,200000}
%\end{align}
%So, from equation \ref{eq:ee18btech11048_greater} and Table\ref{table:ee18btech11048_ Example_Table}
%\begin{align}
%T &\approx \frac{1}{H}\\
% T &= \frac{3}{1000}
%\end{align}
%Hence,
%\begin{align}
%V_o &= 5V_s\\
%\implies V_o &= 5V
%\end{align}
\item Verify your result through spice.
\\
\solution The following readme file provides necessary instructions to simulate the circuit in spice.
\begin{lstlisting}
codes/ee18btech11048/spice/README
\end{lstlisting}

The following netlist simulates the given circuit.
\begin{lstlisting}
codes/spice/feedback.net
\end{lstlisting}

\end{enumerate}
